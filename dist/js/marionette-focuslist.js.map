{"version":3,"file":"marionette-focuslist","sources":["marionette-focuslist/src/templates.js","marionette-focuslist/src/utils.js","marionette-focuslist/src/views/focusList.js","marionette-focuslist/src/index.js"],"sourcesContent":["import handlebars from 'handlebars'\n\nexport default {\n'focusList': handlebars.template({\"1\":function(container,depth0,helpers,partials,data) {\n    return \"  <div class=\\\"nano\\\">\\n    <div class=\\\"nano-content\\\" region=\\\"list\\\"></div>\\n  </div>\\n\";\n},\"3\":function(container,depth0,helpers,partials,data) {\n    return \"  <div region=\\\"list\\\"></div>\\n\";\n},\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1;\n\n  return ((stack1 = helpers[\"if\"].call(depth0 != null ? depth0 : {},(depth0 != null ? depth0.scroll : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.program(3, data, 0),\"data\":data})) != null ? stack1 : \"\");\n},\"useData\":true}),\n}\n","\nimport _ from 'lodash'\n\nfunction transfer (sender, receiver, eventName) {\n  sender.listenTo(sender, eventName, function () {\n    var args = _([eventName]).concat(arguments).value()\n    receiver.trigger.apply(receiver, args)\n  })\n}\n\nexport default {\n  transfer\n}\n","\nimport animation from 'animation'\nimport marionette from 'marionette'\n\nimport templates from '../templates'\nimport utils from '../utils'\n\nconst ListView = marionette.CollectionView.extend({\n  tagName: 'ul',\n  childEvents: {\n    focus: 'onChildFocus',\n    select: 'onChildSelect'\n  },\n  filter: function (child) {\n    return !(child.get('visible') === false)\n  },\n  onChildFocus: function (child) {\n    if (child.$el.is(':not(.disabled)')) {\n      this.$el.children().removeClass('focus')\n      child.$el.addClass('focus')\n    }\n  },\n  onChildSelect: function (child) {\n    this.trigger('select', child)\n  }\n})\n\nexport default marionette.LayoutView.extend({\n  template: templates['focusList'],\n  attributes: {\n    class: 'focusList'\n  },\n  events: {\n    'keydown': 'onKeyDown'\n  },\n  regions: {\n    list: '[region=list]'\n  },\n  ui: {\n    scroll: '.nano',\n    content: '.nano-content'\n  },\n  keyEvents: {\n    13: 'onEnterKey',\n    32: 'onSpaceKey',\n    38: 'onArrowUpKey',\n    40: 'onArrowDownKey'\n  },\n  initialize: function (options) {\n    this.maxSize = options.maxSize\n    this.childView = options.childView\n    this.collection = options.collection\n  },\n  onShow: function () {\n    this.refreshScroll()\n  },\n  onRender: function () {\n    // Create child views\n    this.listView = new ListView({\n      childView: this.childView,\n      collection: this.collection\n    })\n    // Render the list view when the collection changes\n    this.listenTo(this.collection, 'change', () => this.listView.render())\n    // Transfer list view events to parent\n    utils.transfer(this.listView, this, 'render:collection')\n    utils.transfer(this.listView, this, 'select')\n    // Show child views\n    this.showChildView('list', this.listView)\n  },\n  onKeyDown: function (e) {\n    var method = this.keyEvents[e.keyCode]\n    if (method !== undefined) {\n      this[method]()\n      e.preventDefault()\n    }\n  },\n  onArrowUpKey: function () {\n    let focusedView = this.findFocusedItem()\n    if (focusedView === undefined) {\n      this.listView.$el.children().last().addClass('focus')\n    } else {\n      let items = this.listView.$el.children(':not(.disabled)')\n      let index = items.index(focusedView.el)\n      index = index - 1\n      index = (index < 0) ? (items.length - 1) : index\n      this.focusItem(items, index)\n    }\n  },\n  onArrowDownKey: function () {\n    var focusedView = this.findFocusedItem()\n    if (focusedView === undefined) {\n      this.listView.$el.children().first().addClass('focus')\n    } else {\n      var items = this.listView.$el.children(':not(.disabled)')\n      var index = items.index(focusedView.el)\n      index = index + 1\n      index = (index > (items.length - 1)) ? 0 : index\n      this.focusItem(items, index)\n    }\n  },\n  onEnterKey: function () {\n    this.itemSelect()\n  },\n  onSpaceKey: function () {\n    this.itemSelect()\n  },\n  serializeData: function () {\n    return {scroll: this.options.scroll}\n  },\n  focusItem: function (items, index) {\n    var item = items.eq(index)\n    items.removeClass('focus')\n    item.addClass('focus')\n    animation.scroll(item, this.ui.content)\n  },\n  itemSelect: function (e) {\n    var focusedView = this.findFocusedItem()\n    this.listView.$el.children().removeClass('focus')\n    if (focusedView !== undefined) {\n      this.trigger('select', focusedView)\n    }\n  },\n  findFocusedItem: function () {\n    return this.listView.children.find(function (child) {\n      return child.$el.hasClass('focus')\n    })\n  },\n  findByModel: function (model) {\n    return this.listView.children.findByModel(model)\n  },\n  refreshScroll: function () {\n    if (this.options.scroll) {\n      this.ui.scroll.nanoScroller({alwaysVisible: true})\n    }\n  },\n  getListWidth: function () {\n    var width = null\n    this.ui.content.css({position: 'relative'})\n    width = this.$el.outerWidth()\n    this.ui.content.css({position: 'absolute'})\n    return width\n  }\n})\n","\nimport FocusListView from './views/focusList'\n\nexport default {\n  FocusListView\n}\n"],"names":["handlebars","template","container","depth0","helpers","partials","data","stack1","call","scroll","program","transfer","sender","receiver","eventName","listenTo","args","_","concat","arguments","value","trigger","apply","ListView","marionette","CollectionView","extend","tagName","childEvents","focus","select","filter","child","get","onChildFocus","$el","is","children","removeClass","addClass","onChildSelect","LayoutView","templates","attributes","class","events","regions","list","ui","content","keyEvents","initialize","options","maxSize","childView","collection","onShow","refreshScroll","onRender","listView","render","utils","showChildView","onKeyDown","e","method","keyCode","undefined","preventDefault","onArrowUpKey","focusedView","findFocusedItem","last","items","index","el","length","focusItem","onArrowDownKey","first","onEnterKey","itemSelect","onSpaceKey","serializeData","item","eq","animation","find","hasClass","findByModel","model","nanoScroller","alwaysVisible","getListWidth","width","css","position","outerWidth","FocusListView"],"mappings":"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"}