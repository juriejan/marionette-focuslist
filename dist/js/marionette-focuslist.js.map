{"version":3,"file":"marionette-focuslist","sources":["marionette-focuslist/src/templates.js","marionette-focuslist/src/views/focusList.js","marionette-focuslist/src/index.js"],"sourcesContent":["import handlebars from 'handlebars'\n\nexport default {\n'focusList': handlebars.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<div class=\\\"nano\\\">\\n  <div class=\\\"nano-content\\\">\\n    <ul></ul>\\n  </div>\\n</div>\\n\";\n},\"useData\":true}),\n}\n","\nimport _ from 'lodash'\n\nimport animation from 'animation'\nimport Marionette from 'marionette'\n\nimport templates from '../templates'\n\nexport default Marionette.CompositeView.extend({\n  template: templates['focusList'],\n  attributes: {\n    class: 'focusList'\n  },\n  events: {\n    'keydown': 'onKeyDown'\n  },\n  childViewContainer: 'ul',\n  childEvents: {\n    focus: 'onChildFocus',\n    select: 'onChildSelect'\n  },\n  ui: {\n    scroll: '.nano',\n    content: '.nano-content',\n    list: 'ul'\n  },\n  keyEvents: {\n    13: 'itemSelect',\n    32: 'itemSelect',\n    38: 'onArrowUpKey',\n    40: 'onArrowDownKey'\n  },\n  initialize: function (options) {\n    this.maxSize = options.maxSize\n  },\n  onShow: function () {\n    this.refreshScroll()\n  },\n  onAttach: function () {\n    this.resetHeight()\n  },\n  onRender: function () {\n    this.resetHeight()\n  },\n  onChildFocus: function (child) {\n    if (child.$el.is(':not(.disabled)')) {\n      this.ui.list.children().removeClass('focus')\n      child.$el.addClass('focus')\n    }\n  },\n  onChildSelect: function (child) {\n    this.trigger('select', child)\n  },\n  onKeyDown: function (e) {\n    var method = this.keyEvents[e.keyCode]\n    if (method !== undefined) {\n      this[method]()\n      e.preventDefault()\n    }\n  },\n  onArrowUpKey: function () {\n    var focusedView = this.findFocusedItem()\n    if (focusedView === undefined) {\n      this.ui.list.children().last().addClass('focus')\n    } else {\n      var items = this.ui.list.children(':not(.disabled)')\n      var index = items.index(focusedView.el)\n      index = index - 1\n      index = (index < 0) ? (items.length - 1) : index\n      this.focusItem(items, index)\n    }\n  },\n  onArrowDownKey: function () {\n    var focusedView = this.findFocusedItem()\n    if (focusedView === undefined) {\n      this.ui.list.children().first().addClass('focus')\n    } else {\n      var items = this.ui.list.children(':not(.disabled)')\n      var index = items.index(focusedView.el)\n      index = index + 1\n      index = (index > (items.length - 1)) ? 0 : index\n      this.focusItem(items, index)\n    }\n  },\n  focusItem: function (items, index) {\n    var item = items.eq(index)\n    items.removeClass('focus')\n    item.addClass('focus')\n    animation.scroll(item, this.ui.content)\n  },\n  filter: function (child) {\n    return !(child.get('visible') === false)\n  },\n  itemSelect: function (e) {\n    var focusedView = this.findFocusedItem()\n    this.ui.list.children().removeClass('focus')\n    if (focusedView !== undefined) {\n      this.trigger('select', focusedView)\n    }\n  },\n  findFocusedItem: function () {\n    return this.children.find(function (child) {\n      return child.$el.hasClass('focus')\n    })\n  },\n  refreshScroll: function () {\n    this.ui.scroll.nanoScroller({alwaysVisible: true})\n  },\n  resetHeight: function () {\n    this.$el.css('height', `${this.getListHeight()}px`)\n  },\n  getListHeight: function () {\n    var el = this.ui.list\n    var height\n    if (this.maxSize) {\n      // Calculate the height according to the maximum size\n      var firstItem = el.find('li').eq(0)\n      var itemHeight = firstItem.outerHeight()\n      height = _.min([el.height(), (itemHeight * this.maxSize)])\n    } else {\n      height = el.outerHeight()\n    }\n    // Determine and add the outer border widths\n    var topBorderWidth = this.$el.css('border-top-width')\n    var bottomBorderWidth = this.$el.css('border-bottom-width')\n    topBorderWidth = parseInt(topBorderWidth, 10)\n    bottomBorderWidth = parseInt(bottomBorderWidth, 10)\n    height += (topBorderWidth + bottomBorderWidth)\n    // Determine and add the list padding\n    var paddingTop = this.$el.css('padding-top')\n    var paddingBottom = this.$el.css('padding-bottom')\n    paddingTop = parseInt(paddingTop, 10)\n    paddingBottom = parseInt(paddingBottom, 10)\n    height += paddingTop + paddingBottom\n    // Return the calculated height\n    return height\n  },\n  getListWidth: function () {\n    var width = null\n    this.ui.content.css({position: 'relative'})\n    width = this.$el.outerWidth()\n    this.ui.content.css({position: 'absolute'})\n    return width\n  }\n})\n","\nimport FocusListView from './views/focusList'\n\nexport default {\n  FocusListView\n}\n"],"names":[],"mappings":";;;;;;;;;;;oBAEe;AACf,IAAA,iBAAa,WAAW,QAAX,CAAoB,EAAC,YAAW,CAAC,CAAD,EAAG,UAAH,CAAX,EAA0B,QAAO,cAAS,SAAT,EAAmB,MAAnB,EAA0B,OAA1B,EAAkC,QAAlC,EAA2C,IAA3C,EAAiD;AAChH,IAAA,mBAAO,yFAAP,CADgH;aAAjD,EAEjE,WAAU,IAAV,EAFW,CAAb;KADA;;wBCMe,WAAW,aAAX,CAAyB,MAAzB,CAAgC;AAC7C,IAAA,YAAU,UAAU,WAAV,CAAV;AACA,IAAA,cAAY;AACV,IAAA,WAAO,WAAP;OADF;AAGA,IAAA,UAAQ;AACN,IAAA,eAAW,WAAX;OADF;AAGA,IAAA,sBAAoB,IAApB;AACA,IAAA,eAAa;AACX,IAAA,WAAO,cAAP;AACA,IAAA,YAAQ,eAAR;OAFF;AAIA,IAAA,MAAI;AACF,IAAA,YAAQ,OAAR;AACA,IAAA,aAAS,eAAT;AACA,IAAA,UAAM,IAAN;OAHF;AAKA,IAAA,aAAW;AACT,IAAA,QAAI,YAAJ;AACA,IAAA,QAAI,YAAJ;AACA,IAAA,QAAI,cAAJ;AACA,IAAA,QAAI,gBAAJ;OAJF;AAMA,IAAA,cAAY,oBAAU,OAAV,EAAmB;AAC7B,IAAA,SAAK,OAAL,GAAe,QAAQ,OAAR,CADc;OAAnB;AAGZ,IAAA,UAAQ,kBAAY;AAClB,IAAA,SAAK,aAAL,GADkB;OAAZ;AAGR,IAAA,YAAU,oBAAY;AACpB,IAAA,SAAK,WAAL,GADoB;OAAZ;AAGV,IAAA,YAAU,oBAAY;AACpB,IAAA,SAAK,WAAL,GADoB;OAAZ;AAGV,IAAA,gBAAc,sBAAU,KAAV,EAAiB;AAC7B,IAAA,QAAI,MAAM,GAAN,CAAU,EAAV,CAAa,iBAAb,CAAJ,EAAqC;AACnC,IAAA,WAAK,EAAL,CAAQ,IAAR,CAAa,QAAb,GAAwB,WAAxB,CAAoC,OAApC,EADmC;AAEnC,IAAA,YAAM,GAAN,CAAU,QAAV,CAAmB,OAAnB,EAFmC;SAArC;OADY;AAMd,IAAA,iBAAe,uBAAU,KAAV,EAAiB;AAC9B,IAAA,SAAK,OAAL,CAAa,QAAb,EAAuB,KAAvB,EAD8B;OAAjB;AAGf,IAAA,aAAW,mBAAU,CAAV,EAAa;AACtB,IAAA,QAAI,SAAS,KAAK,SAAL,CAAe,EAAE,OAAF,CAAxB,CADkB;AAEtB,IAAA,QAAI,WAAW,SAAX,EAAsB;AACxB,IAAA,WAAK,MAAL,IADwB;AAExB,IAAA,QAAE,cAAF,GAFwB;SAA1B;OAFS;AAOX,IAAA,gBAAc,wBAAY;AACxB,IAAA,QAAI,cAAc,KAAK,eAAL,EAAd,CADoB;AAExB,IAAA,QAAI,gBAAgB,SAAhB,EAA2B;AAC7B,IAAA,WAAK,EAAL,CAAQ,IAAR,CAAa,QAAb,GAAwB,IAAxB,GAA+B,QAA/B,CAAwC,OAAxC,EAD6B;SAA/B,MAEO;AACL,IAAA,UAAI,QAAQ,KAAK,EAAL,CAAQ,IAAR,CAAa,QAAb,CAAsB,iBAAtB,CAAR,CADC;AAEL,IAAA,UAAI,QAAQ,MAAM,KAAN,CAAY,YAAY,EAAZ,CAApB,CAFC;AAGL,IAAA,cAAQ,QAAQ,CAAR,CAHH;AAIL,IAAA,cAAQ,KAAC,GAAQ,CAAR,GAAc,MAAM,MAAN,GAAe,CAAf,GAAoB,KAAnC,CAJH;AAKL,IAAA,WAAK,SAAL,CAAe,KAAf,EAAsB,KAAtB,EALK;SAFP;OAFY;AAYd,IAAA,kBAAgB,0BAAY;AAC1B,IAAA,QAAI,cAAc,KAAK,eAAL,EAAd,CADsB;AAE1B,IAAA,QAAI,gBAAgB,SAAhB,EAA2B;AAC7B,IAAA,WAAK,EAAL,CAAQ,IAAR,CAAa,QAAb,GAAwB,KAAxB,GAAgC,QAAhC,CAAyC,OAAzC,EAD6B;SAA/B,MAEO;AACL,IAAA,UAAI,QAAQ,KAAK,EAAL,CAAQ,IAAR,CAAa,QAAb,CAAsB,iBAAtB,CAAR,CADC;AAEL,IAAA,UAAI,QAAQ,MAAM,KAAN,CAAY,YAAY,EAAZ,CAApB,CAFC;AAGL,IAAA,cAAQ,QAAQ,CAAR,CAHH;AAIL,IAAA,cAAQ,KAAC,GAAS,MAAM,MAAN,GAAe,CAAf,GAAqB,CAA/B,GAAmC,KAAnC,CAJH;AAKL,IAAA,WAAK,SAAL,CAAe,KAAf,EAAsB,KAAtB,EALK;SAFP;OAFc;AAYhB,IAAA,aAAW,mBAAU,KAAV,EAAiB,KAAjB,EAAwB;AACjC,IAAA,QAAI,OAAO,MAAM,EAAN,CAAS,KAAT,CAAP,CAD6B;AAEjC,IAAA,UAAM,WAAN,CAAkB,OAAlB,EAFiC;AAGjC,IAAA,SAAK,QAAL,CAAc,OAAd,EAHiC;AAIjC,IAAA,cAAU,MAAV,CAAiB,IAAjB,EAAuB,KAAK,EAAL,CAAQ,OAAR,CAAvB,CAJiC;OAAxB;AAMX,IAAA,UAAQ,gBAAU,KAAV,EAAiB;AACvB,IAAA,WAAO,EAAE,MAAM,GAAN,CAAU,SAAV,MAAyB,KAAzB,CAAF,CADgB;OAAjB;AAGR,IAAA,cAAY,oBAAU,CAAV,EAAa;AACvB,IAAA,QAAI,cAAc,KAAK,eAAL,EAAd,CADmB;AAEvB,IAAA,SAAK,EAAL,CAAQ,IAAR,CAAa,QAAb,GAAwB,WAAxB,CAAoC,OAApC,EAFuB;AAGvB,IAAA,QAAI,gBAAgB,SAAhB,EAA2B;AAC7B,IAAA,WAAK,OAAL,CAAa,QAAb,EAAuB,WAAvB,EAD6B;SAA/B;OAHU;AAOZ,IAAA,mBAAiB,2BAAY;AAC3B,IAAA,WAAO,KAAK,QAAL,CAAc,IAAd,CAAmB,UAAU,KAAV,EAAiB;AACzC,IAAA,aAAO,MAAM,GAAN,CAAU,QAAV,CAAmB,OAAnB,CAAP,CADyC;SAAjB,CAA1B,CAD2B;OAAZ;AAKjB,IAAA,iBAAe,yBAAY;AACzB,IAAA,SAAK,EAAL,CAAQ,MAAR,CAAe,YAAf,CAA4B,EAAC,eAAe,IAAf,EAA7B,EADyB;OAAZ;AAGf,IAAA,eAAa,uBAAY;AACvB,IAAA,SAAK,GAAL,CAAS,GAAT,CAAa,QAAb,EAA0B,KAAK,aAAL,SAA1B,EADuB;OAAZ;AAGb,IAAA,iBAAe,yBAAY;AACzB,IAAA,QAAI,KAAK,KAAK,EAAL,CAAQ,IAAR,CADgB;AAEzB,IAAA,QAAI,MAAJ,CAFyB;AAGzB,IAAA,QAAI,KAAK,OAAL,EAAc;;AAEhB,IAAA,UAAI,YAAY,GAAG,IAAH,CAAQ,IAAR,EAAc,EAAd,CAAiB,CAAjB,CAAZ,CAFY;AAGhB,IAAA,UAAI,aAAa,UAAU,WAAV,EAAb,CAHY;AAIhB,IAAA,eAAS,EAAE,GAAF,CAAM,CAAC,GAAG,MAAH,EAAD,EAAe,aAAa,KAAK,OAAL,CAAlC,CAAT,CAJgB;SAAlB,MAKO;AACL,IAAA,eAAS,GAAG,WAAH,EAAT,CADK;SALP;;AAHyB,IAAA,QAYrB,iBAAiB,KAAK,GAAL,CAAS,GAAT,CAAa,kBAAb,CAAjB,CAZqB;AAazB,IAAA,QAAI,oBAAoB,KAAK,GAAL,CAAS,GAAT,CAAa,qBAAb,CAApB,CAbqB;AAczB,IAAA,qBAAiB,SAAS,cAAT,EAAyB,EAAzB,CAAjB,CAdyB;AAezB,IAAA,wBAAoB,SAAS,iBAAT,EAA4B,EAA5B,CAApB,CAfyB;AAgBzB,IAAA,cAAW,iBAAiB,iBAAjB;;AAhBc,IAAA,QAkBrB,aAAa,KAAK,GAAL,CAAS,GAAT,CAAa,aAAb,CAAb,CAlBqB;AAmBzB,IAAA,QAAI,gBAAgB,KAAK,GAAL,CAAS,GAAT,CAAa,gBAAb,CAAhB,CAnBqB;AAoBzB,IAAA,iBAAa,SAAS,UAAT,EAAqB,EAArB,CAAb,CApByB;AAqBzB,IAAA,oBAAgB,SAAS,aAAT,EAAwB,EAAxB,CAAhB,CArByB;AAsBzB,IAAA,cAAU,aAAa,aAAb;;AAtBe,IAAA,WAwBlB,MAAP,CAxByB;OAAZ;AA0Bf,IAAA,gBAAc,wBAAY;AACxB,IAAA,QAAI,QAAQ,IAAR,CADoB;AAExB,IAAA,SAAK,EAAL,CAAQ,OAAR,CAAgB,GAAhB,CAAoB,EAAC,UAAU,UAAV,EAArB,EAFwB;AAGxB,IAAA,YAAQ,KAAK,GAAL,CAAS,UAAT,EAAR,CAHwB;AAIxB,IAAA,SAAK,EAAL,CAAQ,OAAR,CAAgB,GAAhB,CAAoB,EAAC,UAAU,UAAV,EAArB,EAJwB;AAKxB,IAAA,WAAO,KAAP,CALwB;OAAZ;KAjID,CAAf;;gBCLe;AACb,IAAA,8BADa;KAAf;;;;"}